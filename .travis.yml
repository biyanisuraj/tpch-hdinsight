sudo: required

services:
  - docker

install:
  - shopt -s expand_aliases

script:
  - docker-compose -f docker/docker-compose.yml up -d namenode hive-metastore-postgresql datanode hive-metastore hive-server && docker exec hive-server bash -c "git clone https://github.com/dharmeshkakadia/tpch-datagen-as-hive-query/ && cd tpch-datagen-as-hive-query && hive -i settings.hql -f TPCHDataGen.hql -hiveconf SCALE=2 -hiveconf PARTS=2 -hiveconf LOCATION=/HiveTPCH/ -hiveconf TPCHBIN=resources && hive -i settings.hql -f ddl/createAllExternalTables.hql -hiveconf LOCATION=/HiveTPCH/ -hiveconf DBNAME=tpch" 
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query1.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query2.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query3.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query4.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query5.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query6.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query7.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query8.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query9.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query10.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query11.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query12.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query13.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query14.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query15.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query16.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query17.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query18.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query19.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query20.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query21.hql"
  - docker exec hive-server bash -c "hive -database tpch -i tpch-datagen-as-hive-query/settings.hql -f tpch-datagen-as-hive-query/queries/tpch_query22.hql"
  